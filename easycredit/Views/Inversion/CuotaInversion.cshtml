@model IEnumerable<easycredit.Models.PagoInversion>

@{
    Layout = "_Layout";
    ViewData["Title"] = "Cuotas";
    ViewData["Seccion"] = "Inversion";
    int numero = 0;
    int? plazo = 0;
    int? pendientes = 0;
    var cliente = "";
    double monto = 0;
    double total = 0;

}


    @if (Model.Any())
    {
        <section class="tabla">
    <h1 class="text-center">Tabla de cuotas</h1>
        <table class="table table-hover table-striped">
            <caption>Tabla de Cuotas</caption>
            <thead class="table-dark">
                <tr>
                    <th>
                        #.
                    </th>
                    <th>
                        Fecha Efectiva
                    </th>
                    <th>
                        Capital inicial
                    </th>


                    <th>
                        Cuota
                    </th>
                    <th>
                        Interes
                    </th>
                    <th>
                        Abono
                    </th>
                    <th>
                        Saldo Pendiente
                    </th>


                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {

                    <tr>
                        @{
                            numero++;
                        }
                        <td>
                            @numero
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.FechaEfectiva)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.CapitalInicial)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.Cuota)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.Interes)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.Abono)
                        </td>
                        <td>
                            @Html.DisplayFor(model => item.Amortizacion)
                        </td>
                        @{
                            plazo = item.CodigoInversionNavigation.Plazo;
                            cliente = item.CodigoInversionNavigation.Cliente.Nombre;
                            monto = (double)item.CodigoInversionNavigation.Monto;
                            total = Math.Round((double)item.Amortizacion, 2);
                        }
                    </tr>
                }
            </tbody>
        </table>

        <div class="row">
            @{
                pendientes = plazo - numero;
            }
            <h2 class="text-black-50">Datos</h2>
            <div class="col-3">
                <h4 class="text-danger">Pendientes: <i class="text-black-50">@pendientes</i></h4>
                <h4>Cliente: <i class="text-black-50">@cliente</i></h4>

            </div>
            <div class="col-6">
                <h4 class="">Monto Inversion: <i class="text-black-50">@monto</i></h4>
                <h4>Total Pendiente: <i class="text-black-50">@total</i></h4>
             
            </div>

        </div>
         </section>
        <a class="btn btn-primary ml-1 float-end  btn-sm" asp-action="Vigentes"><i class="bi bi-arrow-return-left"></i> Volver</a>
        <button class="btn btn-success ml-1 float-end imprimir  btn-sm" ><i class="bi bi-printer"></i> Imprimir</button>
       
    }else{
        <h3 class="text-black-50 text-center">No hay registros que mostrar!</h3>
        <a class="btn btn-primary ml-1 float-end  btn-sm" asp-action="Vigentes"><i class="bi bi-arrow-return-left"></i> Volver</a>

    }


<script>
        document.querySelector(".imprimir").addEventListener('click',(e)=>{
            e.preventDefault();
         let content = document.querySelector(".tabla").innerHTML;

               window.document.write(content);
                window.document.close();
              //  console.log(content)
                const head = window.document.getElementsByTagName("head");
                head[0].innerHTML = '<link rel="stylesheet" href="../../lib/bootstrap/dist/css/bootstrap.min.css" />';

             setTimeout(()=>{
                  window.print();
                window.close();
              window.location = "/Inversion/Vigentes";
             },500)


        })



</script>

